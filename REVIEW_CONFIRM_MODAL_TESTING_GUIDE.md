# 🧪 คู่มือทดสอบ ReviewConfirmModal

## 📍 ตำแหน่งของ ReviewConfirmModal

ReviewConfirmModal จะปรากฏ**หลังจาก**กดปุ่ม "ตรวจทาน (REVIEW & CONFIRM)" ใน DispatcherActionModal

---

## 🔍 วิธีทดสอบทีละขั้นตอน

### ขั้นตอนที่ 1: เข้าสู่ระบบ

1. เปิดเบราว์เซอร์ไปที่ `http://localhost:5173` (หรือ port ที่ใช้)
2. Login ในฐานะ **Dispatcher**
   - Username: `dispatcher@company.com` (หรือ Dispatcher account ที่มี)

### ขั้นตอนที่ 2: เปิด Developer Console

1. กด `F12` (Windows/Linux) หรือ `Cmd + Option + I` (Mac)
2. ไปที่แท็บ **Console**
3. เตรียมดูข้อความ Debug

### ขั้นตอนที่ 3: เปิด Dispatcher Dashboard

1. คลิกที่เมนู **"Dispatcher"** หรือ **"จัดรถ"**
2. จะเห็นรายการงานทั้งหมด

### ขั้นตอนที่ 4: เลือกงานที่ต้องการมอบหมาย

**ตัวเลือก A: งานใหม่ (NEW_REQUEST)**

- คลิกที่งานที่มีสถานะ **"NEW REQUEST"** (สีส้ม)
- หรือ **"PENDING PRICING"** (สีเหลือง)

**ตัวเลือก B: งานที่มอบหมายแล้ว (ASSIGNED)**

- คลิกที่งานที่มีสถานะ **"ASSIGNED"** (สีเขียว)
- เพื่อแก้ไขข้อมูล

### ขั้นตอนที่ 5: กรอกข้อมูลใน DispatcherActionModal

จะเห็นหน้าต่าง **"การจัดการข้อมูลการจัดรถ"** ปรากฏขึ้น

**กรอกข้อมูลต่อไปนี้:**

1. **เลือก Subcontractor** (บังคับ)
   - คลิกที่การ์ด Smart Recommendation
   - หรือพิมพ์ชื่อบริษัทในช่อง Search

2. **เลือก Truck Type** (บังคับ)
   - เลือกจาก Dropdown

3. **กรอกข้อมูล Fleet** (ไม่บังคับ แต่แนะนำ)
   - ชื่อคนขับ (Driver Name)
   - เบอร์โทรศัพท์ (Phone)
   - ทะเบียนรถ (License Plate)

### ขั้นตอนที่ 6: กดปุ่ม "ตรวจทาน"

1. เลื่อนลงไปด้านล่างสุดของ Modal
2. จะเห็นปุ่ม **"ตรวจทาน (REVIEW & CONFIRM)"** สีน้ำเงิน
3. **กดปุ่มนี้**

### ขั้นตอนที่ 7: ตรวจสอบ Console

ใน Console ควรเห็นข้อความ:

```
🔍 Opening ReviewConfirmModal...
```

### ขั้นตอนที่ 8: ดู ReviewConfirmModal

**ถ้าทำงานถูกต้อง จะเห็น:**

```
┌─────────────────────────────────────────────┐
│  📋 ตรวจทานข้อมูลก่อนยืนยัน                 │
│  (Header สีน้ำเงิน-ม่วง Gradient)           │
├─────────────────────────────────────────────┤
│                                             │
│  📌 รายละเอียดใบงาน                         │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│  Job ID: JRS-2026-XXXX                      │
│  Route: ต้นทาง → ปลายทาง                   │
│  ...                                        │
│                                             │
│  🚛 ข้อมูลการจัดรถ (สีเขียว)               │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│  Subcontractor: ...                         │
│  Driver: ...                                │
│  ...                                        │
│                                             │
│  💰 ข้อมูลราคา (สีน้ำเงิน)                  │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│  Cost: ฿XX,XXX.XX                           │
│  ...                                        │
│                                             │
│  ⚠️ คำเตือนสำคัญ (สีแดง)                   │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│  เมื่อกดยืนยัน ราคาจะถูก LOCK...           │
│                                             │
├─────────────────────────────────────────────┤
│  [กลับไปแก้ไข]  [ยืนยันและล็อก]            │
└─────────────────────────────────────────────┘
```

---

## 🚨 กรณีที่ไม่เห็น ReviewConfirmModal

### ปัญหาที่เป็นไปได้

#### 1. ปุ่ม "ตรวจทาน" ถูก Disabled (สีเทา)

**สาเหตุ:**

- ยังไม่ได้เลือก Subcontractor

**วิธีแก้:**

- เลือก Subcontractor ก่อน
- ปุ่มจะเปลี่ยนเป็นสีน้ำเงินและกดได้

#### 2. ระบบแสดง "Reason for Change" แทน

**สาเหตุ:**

- ระบบตรวจพบว่ามีการเปลี่ยนแปลงข้อมูล
- ต้องระบุเหตุผลก่อน

**วิธีแก้:**

- กรอกเหตุผลในช่อง Dropdown
- กดปุ่ม "ยืนยันการเปลี่ยนแปลง"
- **จากนั้น** ReviewConfirmModal จะปรากฏ

#### 3. มี JavaScript Error

**วิธีตรวจสอบ:**

1. เปิด Console (F12)
2. ดูว่ามีข้อความสีแดงหรือไม่
3. ถ่ายภาพหน้าจอส่งมาให้ช่วยแก้ไข

#### 4. ไม่เห็นข้อความ "🔍 Opening ReviewConfirmModal..."

**สาเหตุ:**

- ปุ่มไม่ได้ถูกกด
- หรือมี Logic ที่ทำให้ไม่เข้า else block

**วิธีแก้:**

- ลองกดปุ่มอีกครั้ง
- ตรวจสอบว่ากรอกข้อมูลครบหรือไม่

---

## 📸 ภาพตัวอย่าง

### ก่อนกดปุ่ม "ตรวจทาน"

```
┌─────────────────────────────────────────┐
│  การจัดการข้อมูลการจัดรถ                │
│  (DispatcherActionModal)                │
├─────────────────────────────────────────┤
│  ... กรอกข้อมูล ...                     │
├─────────────────────────────────────────┤
│  [ย้อนกลับ]  [ตรวจทาน ← กดที่นี่]      │
└─────────────────────────────────────────┘
```

### หลังกดปุ่ม "ตรวจทาน"

```
┌─────────────────────────────────────────┐
│  📋 ตรวจทานข้อมูลก่อนยืนยัน             │
│  (ReviewConfirmModal - หน้าต่างใหม่!)   │
├─────────────────────────────────────────┤
│  ... แสดงข้อมูลทั้งหมด ...              │
├─────────────────────────────────────────┤
│  [กลับไปแก้ไข]  [ยืนยันและล็อก]        │
└─────────────────────────────────────────┘
```

---

## 🎯 Checklist การทดสอบ

- [ ] เข้าสู่ระบบในฐานะ Dispatcher
- [ ] เปิด Developer Console (F12)
- [ ] เลือกงานที่ต้องการมอบหมาย
- [ ] กรอก Subcontractor (บังคับ)
- [ ] กรอก Truck Type (บังคับ)
- [ ] กรอกข้อมูล Fleet (แนะนำ)
- [ ] กดปุ่ม "ตรวจทาน (REVIEW & CONFIRM)"
- [ ] เห็นข้อความ "🔍 Opening ReviewConfirmModal..." ใน Console
- [ ] เห็น ReviewConfirmModal ปรากฏขึ้น
- [ ] ตรวจสอบข้อมูลใน ReviewConfirmModal
- [ ] ทดสอบปุ่ม "กลับไปแก้ไข"
- [ ] ทดสอบปุ่ม "ยืนยันและล็อก"

---

## 💡 Tips

1. **ถ้ายังไม่เห็น** ลองรีเฟรชหน้าเว็บ (Ctrl + R หรือ Cmd + R)
2. **ถ้ามี Error** ถ่ายภาพหน้าจอ Console ส่งมาให้ช่วยแก้ไข
3. **ถ้าปุ่มกดไม่ได้** ตรวจสอบว่ากรอก Subcontractor แล้วหรือยัง
4. **ถ้าต้องการดู Source Code** เปิดไฟล์:
   - `components/ReviewConfirmModal.tsx`
   - `components/DispatcherActionModal.tsx`

---

**สร้างเมื่อ:** 16 มกราคม 2026  
**อัพเดทล่าสุด:** 16 มกราคม 2026
